



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1, mkdocs-material-4.6.3">
    
    
      
        <title>Build a teams search app using aequos MDV, Microsoft Graph extensions and SharePoint taxonomy. - aequos Modern Data Visualizer solution for SharePoint Online</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/application.adb8469c.css">
      
        <link rel="stylesheet" href="../../../assets/stylesheets/application-palette.a8b3c06d.css">
      
      
        
        
        <meta name="theme-color" content="">
      
    
    
      <script src="../../../assets/javascripts/modernizr.86422ebf.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=:300,400,400i,700%7CUbuntu+Mono&display=fallback">
        <style>body,input{font-family:"","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Ubuntu Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../../../assets/extra.css">
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="black" data-md-color-accent="">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#build-a-teams-search-app-using-aequos-mdv-microsoft-graph-extensions-and-sharepoint-taxonomy" tabindex="0" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../../.." title="aequos Modern Data Visualizer solution for SharePoint Online" aria-label="aequos Modern Data Visualizer solution for SharePoint Online" class="md-header-nav__button md-logo">
          
            <img alt="logo" src="../../../assets/aequos_logo.png" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              aequos Modern Data Visualizer solution for SharePoint Online
            </span>
            <span class="md-header-nav__topic">
              
                Build a teams search app using aequos MDV, Microsoft Graph extensions and SharePoint taxonomy.
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" aria-label="search" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/aequos-solutions/aequos.github.io/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

<nav class="md-tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../.." class="md-tabs__link">
          Getting Started
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../usage/data-visualizer/" class="md-tabs__link">
          Data Visualizer
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../usage/data-filters/" class="md-tabs__link">
          Data Filters
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../usage/data-verticals/" class="md-tabs__link">
          Data Verticals
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../usage/search-box/" class="md-tabs__link">
          Search Box
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../extensibility/" class="md-tabs__link">
          Extensibility
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../build_complete_search_center/" class="md-tabs__link">
          Tutorials
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../../.." title="aequos Modern Data Visualizer solution for SharePoint Online" class="md-nav__button md-logo">
      
        <img alt="logo" src="../../../assets/aequos_logo.png" width="48" height="48">
      
    </a>
    aequos Modern Data Visualizer solution for SharePoint Online
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/aequos-solutions/aequos.github.io/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1">
    
    <label class="md-nav__link" for="nav-1">
      Getting Started
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        Getting Started
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../.." title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../installation/" title="Installation" class="md-nav__link">
      Installation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../setup_standalone/" title="Activate a standalone license" class="md-nav__link">
      Activate a standalone license
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../connections_chart/" title="Connections overview" class="md-nav__link">
      Connections overview
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Data Visualizer
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Data Visualizer
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../usage/data-visualizer/" title="Usage" class="md-nav__link">
      Usage
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../usage/data-visualizer/data-sources/" title="Data sources" class="md-nav__link">
      Data sources
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../usage/data-visualizer/slots/" title="Slots" class="md-nav__link">
      Slots
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../usage/data-visualizer/tokens/" title="Tokens" class="md-nav__link">
      Tokens
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../usage/data-visualizer/layouts/" title="Layouts" class="md-nav__link">
      Layouts
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../usage/data-visualizer/connections/" title="Connections" class="md-nav__link">
      Connections
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../extensibility/" title="Extensibility" class="md-nav__link">
      Extensibility
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Data Filters
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Data Filters
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../usage/data-filters/" title="Usage" class="md-nav__link">
      Usage
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../usage/data-filters/layouts/" title="Layouts" class="md-nav__link">
      Layouts
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Data Verticals
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Data Verticals
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../usage/data-verticals/" title="Usage" class="md-nav__link">
      Usage
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Search Box
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Search Box
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../usage/search-box/" title="Usage" class="md-nav__link">
      Usage
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Extensibility
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Extensibility
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../extensibility/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../extensibility/templating/" title="Templating" class="md-nav__link">
      Templating
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../extensibility/custom_data_source/" title="Custom data source" class="md-nav__link">
      Custom data source
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../extensibility/custom_layout/" title="Custom layout" class="md-nav__link">
      Custom layout
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../extensibility/custom_web_component/" title="Custom web component" class="md-nav__link">
      Custom web component
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../extensibility/custom_suggestions_provider/" title="Custom suggestions provider" class="md-nav__link">
      Custom suggestions provider
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../extensibility/handlebars_customizations/" title="Custom Handlebars customizations" class="md-nav__link">
      Custom Handlebars customizations
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      Tutorials
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        Tutorials
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../build_complete_search_center/" title="Build a complete search center" class="md-nav__link">
      Build a complete search center
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../build_people_directory_graph/" title="Build a people directory using the Microsoft Graph data source" class="md-nav__link">
      Build a people directory using the Microsoft Graph data source
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../build_people_directory_sharepoint_search/" title="Build a people directory using alphabetical verticals and SharePoint Search data source" class="md-nav__link">
      Build a people directory using alphabetical verticals and SharePoint Search data source
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../static_taxonomy_filters_sharepoint_search/" title="Use static taxonomy filters with the SharePoint search data source" class="md-nav__link">
      Use static taxonomy filters with the SharePoint search data source
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-create-microsoft-graph-schema-extension" class="md-nav__link">
    1. Create Microsoft Graph schema extension
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-tag-your-teams-with-your-new-extension-and-taxonomy-values" class="md-nav__link">
    2. Tag your Teams with your new extension and taxonomy values
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-build-a-sharepoint-search-page-using-the-modern-data-visualizer-web-part" class="md-nav__link">
    3. Build a SharePoint search page using the Modern Data Visualizer Web Part
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-create-a-teams-application-an-expose-it-ot-users" class="md-nav__link">
    4. Create a Teams application an expose it ot users
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/aequos-solutions/aequos.github.io/blob/master/docs/getting_started/tutorials/build_teams_search_portal_using_taxnomy.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="build-a-teams-search-app-using-aequos-mdv-microsoft-graph-extensions-and-sharepoint-taxonomy">Build a teams search app using aequos MDV, Microsoft Graph extensions and SharePoint taxonomy.<a class="headerlink" href="#build-a-teams-search-app-using-aequos-mdv-microsoft-graph-extensions-and-sharepoint-taxonomy" title="Permanent link">&para;</a></h1>
<p>Recently, we had a customer. Because, the Modern Data Visualizer was a perfect fit for its requirement.</p>
<ul>
<li>Crateion a search interface only for Teams</li>
<li>Packing to a Teams applications so uers can access their Teams diretly thorugh the Teams client.</li>
</ul>
<p>In this tutorial, we will cover how to build a search center for levering the aequos Modern Data Visualizer solution, Microsoft Graph schema extensions and SharPoint taxonomy.</p>
<p>Why classify tmeas?</p>
<p>The common approach would be to maintain a SharePoint list maping existing Teams and use taxonmy columns to it, then use traditionnal SharePoiunt search to filte. The downside of this approach is you have to maintain this synchronization and don't have a live results. </p>
<p>Inconvenient of the Teams application (web or desktop)</p>
<ul>
<li>Can't add custom metadata in the deskt. The only filter is by name or description.</li>
<li>Display and filter experience poor performances can be very slow when the user is a member of several Teams.</li>
</ul>
<p>Technologies used</p>
<ul>
<li>Microsoft Graph schema extensions</li>
<li>SharePoint taxonomy</li>
<li>
<p>aequos Modern Data Visualizer solution</p>
</li>
<li>
<p>Create taxonomy term sets</p>
</li>
</ul>
<p>For this example, we create two SharePoint taxonomy term sets for our Teams classificaiton:</p>
<ul>
<li><em>"Group type"</em>: the type of Team created (Project, Community, Oganizaional)</li>
<li>
<p><em>"Department"</em>: the organization departement associated with the group.</p>
<p><img alt="&quot;Teams custom metadata - SharePoint taxonomy&quot;" class="center" src="../../../assets/scenarios/teams/teams_term_store.png" /></p>
</li>
</ul>
<h2 id="1-create-microsoft-graph-schema-extension">1. Create Microsoft Graph schema extension<a class="headerlink" href="#1-create-microsoft-graph-schema-extension" title="Permanent link">&para;</a></h2>
<p>To be able to set custom metadata for your Teams, you will need first to create a Microsoft Graph schema extension on the underlying <code>group</code> resource. Microsoft Graph extensions are a way provided by Microsoft to add custom data on Microsoft 365 resources (ex: <code>group</code>,<code>user</code>, etc.)</p>
<p><strong><em>Why using a schema extension instead of an open extension?</em></strong></p>
<blockquote>
<p>Simply because only schema extension can be filtered using the OData <code>$filter</code> expression. To build a a search center, this could be useful asa you will see it ;).</p>
</blockquote>
<p>As of today, Microsoft Schema extension don't not support complex property types like arrays (https://docs.microsoft.com/en-us/graph/api/resources/extensionschemaproperty?view=graph-rest-1.0) and string values are limited to 256 characters.</p>
<p>Using Microsoft Graph explorer</p>
<ul>
<li>
<p>In the same Azure tenant where the Teams you want to tag belong, create a blank Azure AD application and save its ID for later. There is no need to configure any permissions.</p>
<p><img alt="&quot;Teams custom metadata - Azure AD Application register&quot;" class="center" src="../../../assets/scenarios/teams/AzureAD_App_Register.png" /></p>
<p><img alt="&quot;Teams custom metadata - Azure AD Application ID&quot;" class="center" src="../../../assets/scenarios/teams/AzureAD_App_ID.png" /> </p>
</li>
</ul>
<blockquote>
<p>To be able to create a schema extension in Microsoft Graph, you need to "prove" you actually own a tenant to use it. This is done by providing an unique ID of an Azure AD application in your Active Directoy at extension cration time (in the <code>owner</code> proeprty). This application doesn't need to do more than just exist in the tenant.</p>
</blockquote>
<ul>
<li>Open the <a href="https://aka.ms/ge">Microsoft Graph explorer</a> and connect with a Microsoft 365 global administrator account.</li>
<li>In the URL input enter <code>https://graph.microsoft.com/v1.0/schemaExtensions</code> and <code>POST</code> for the HTTP method.</li>
<li>
<p>On the <strong>'Modify permissions'</strong> tab, consent the listed permissions:</p>
<p><img alt="&quot;Teams custom metadata - Graph Explorer permissions&quot;" class="center" src="../../../assets/scenarios/teams/graph_explorer_permissions.png" /></p>
</li>
<li>
<p>In the <strong>'Request body'</strong> tab, use the following body payloay with your information and press <strong>'Run Query'</strong>:</p>
</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="p">{</span>
    <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;aequosGroupMetadata&quot;</span><span class="p">,</span> <span class="err">//</span> <span class="err">Your</span> <span class="err">extension</span> <span class="err">name</span>
    <span class="nt">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Extension for Microsoft 365 groups custom metadata&quot;</span><span class="p">,</span>
    <span class="nt">&quot;targetTypes&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;Group&quot;</span>
    <span class="p">],</span>
    <span class="nt">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;InDevelopment&quot;</span><span class="p">,</span>
    <span class="nt">&quot;owner&quot;</span><span class="p">:</span> <span class="s2">&quot;7e49583b-80e1-4ea7-8bc5-xxxxxxxxx&quot;</span><span class="p">,</span> <span class="err">//</span> <span class="err">Replace</span> <span class="err">with</span> <span class="err">your</span> <span class="err">own</span> <span class="err">Azure</span> <span class="err">AD</span> <span class="err">application</span> <span class="err">ID</span> 
    <span class="nt">&quot;properties&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;groupType&quot;</span><span class="p">,</span>
            <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;String&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;groupTypeAsText&quot;</span><span class="p">,</span>
            <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;String&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;groupDepartment&quot;</span><span class="p">,</span>
            <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;String&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;groupDepartmentAsText&quot;</span><span class="p">,</span>
            <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;String&quot;</span>
        <span class="p">},</span>
    <span class="p">]</span>
<span class="p">}</span>
</code></pre></div>


<p><img alt="&quot;Teams custom metadata - Graph Explorer payload&quot;" class="center" src="../../../assets/scenarios/teams/graph_explorer_payload.png" /></p>
<ul>
<li>
<p>You should see the HTTP response like this:</p>
<p><img alt="&quot;Teams custom metadata - Graph Explorer response&quot;" class="center" src="../../../assets/scenarios/teams/graph_explorer_response.png" /></p>
<p><strong>IMPORTANT</strong></p>
<blockquote>
<p>When you create your extension for the first time, you need to save its generated id as you won't be able to retrieve it afterwards. Microsoft Graph extensions are shared across all tenants worldwide (only the definition, not values).</p>
</blockquote>
</li>
</ul>
<h2 id="2-tag-your-teams-with-your-new-extension-and-taxonomy-values">2. Tag your Teams with your new extension and taxonomy values<a class="headerlink" href="#2-tag-your-teams-with-your-new-extension-and-taxonomy-values" title="Permanent link">&para;</a></h2>
<p>As you probably want to tag not just on Team in your organization ,this step can be automated using multiple ways ex: (process a CSV files with PowerShell or use a custom business application). In this sample, we will just show how to tag a single Team using Graph Explorer. The concept remains the same for multiple Teams. </p>
<ul>
<li>In the Microsoft Graph Explorer, get the list of your Teams using the <code>https://graph.microsoft.com/beta/groups?$filter=resourceProvisioningOptions/Any(x:x eq 'Team')</code> URL (GET) and choose one in the list you wnat to tag saving its <code>id</code>:</li>
</ul>
<p><img alt="&quot;Teams custom metadata - Graph Explorer get Teams&quot;" class="center" src="../../../assets/scenarios/teams/graph_explorer_get_teams.png" /></p>
<ul>
<li>In the Graph Explorer, using this ID, update the group with the SharePoint taxonomy term values. As a convention, we will use the SharePoint taxonomy term IDs as the main extension properties value and the term labels for the 'AsText' properties:</li>
</ul>
<p><img alt="&quot;Teams custom metadata - Graph Explorer tag Teams&quot;" class="center" src="../../../assets/scenarios/teams/graph_explorer_tag_team.png" /></p>
<h2 id="3-build-a-sharepoint-search-page-using-the-modern-data-visualizer-web-part">3. Build a SharePoint search page using the Modern Data Visualizer Web Part<a class="headerlink" href="#3-build-a-sharepoint-search-page-using-the-modern-data-visualizer-web-part" title="Permanent link">&para;</a></h2>
<p>In a SharePoint modern site (can be any site), create a new page using the 'Home Layout'.</p>
<div class="codehilite"><pre><span></span><code><span class="nb">Connect-PnPOnline</span> <span class="n">-Url</span> <span class="n">https</span><span class="err">:</span><span class="p">/&lt;</span><span class="n">your_site_url</span><span class="p">&gt;</span> <span class="n">-UseWebLogin</span>
<span class="nb">Add-PnPClientSidePage</span> <span class="n">-LayoutType</span> <span class="n">Home</span> <span class="n">-Name</span> <span class="n">teams-search-mdv</span> <span class="n">-CommentsEnabled</span><span class="err">:</span><span class="nv">$false</span>
</code></pre></div>


<ul>
<li>Add Graph permissions for SPFx (Office 365 cli).</li>
</ul>
<div class="codehilite"><pre><span></span><code>m365 login
m365 spo serviceprincipal grant add --resource <span class="s1">&#39;Microsoft Graph&#39;</span> --scope <span class="s1">&#39;GroupMember.Read.All&#39;</span>
m365 spo serviceprincipal grant add --resource <span class="s1">&#39;Microsoft Graph&#39;</span> --scope <span class="s1">&#39;Channel.ReadBasic.All&#39;</span>
m365 spo serviceprincipal grant add --resource <span class="s1">&#39;Microsoft Graph&#39;</span> --scope <span class="s1">&#39;User.Read&#39;</span>
</code></pre></div>


<ul>
<li>Add a vertical section to the page</li>
<li>In the main content zone, add a <em>Data Visualizer</em> Web Part</li>
<li>Configure the data source to be OData</li>
</ul>
<h2 id="4-create-a-teams-application-an-expose-it-ot-users">4. Create a Teams application an expose it ot users<a class="headerlink" href="#4-create-a-teams-application-an-expose-it-ot-users" title="Permanent link">&para;</a></h2>
                
                  
                
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org" target="_blank" rel="noopener">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs</a>
      </div>
      
  <div class="md-footer-social">
    <link rel="stylesheet" href="../../../assets/fonts/font-awesome.css">
    
      <a href="https://twitter.com/aequos_ca" target="_blank" rel="noopener" title="twitter" class="md-footer-social__link fa fa-twitter"></a>
    
      <a href="www.aequos.ca" target="_blank" rel="noopener" title="link" class="md-footer-social__link fa fa-link"></a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../assets/javascripts/application.c33a9706.js"></script>
      
      <script>app.initialize({version:"1.1",url:{base:"../../.."}})</script>
      
    
  </body>
</html>